AWSTemplateFormatVersion: 2010-09-09
Resources:
  ECSCluster:
    Type: 'AWS::ECS::Cluster'
    Properties:
      ClusterName: takehomecluster
  taskdefinition:
    Type: 'AWS::ECS::TaskDefinition'
    Properties:
      containerDefinitions:
          name: takehome-app
          portMappings:
            - containerPort: 80
              hostPort: 80
              protocol: tcp 
      cpu: '256'
      executionRoleArn: 'arn:aws:iam::519927740453:role/takehome'
      memory: '512'
      networkMode: awsvpc
  ECSService:
    Type: 'AWS::ECS::Service'
    Properties:
      ServiceName: takehome-service
      Cluster: !Ref ECSCluster
      DesiredCount: 1
      LaunchType: FARGATE
      NetworkConfiguration:
        AwsvpcConfiguration:
          AssignPublicIp: ENABLED
      TaskDefinition: !Ref taskdefinition
